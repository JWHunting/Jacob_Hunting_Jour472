---
title: "DO Outside Factors Affect Prince George's County MCAP Testing?"
format: html
editor: visual
---

Data Analysis Draft
Jacob Hunting


Introduction 

This data notebook looks at the Maryland Comprehensive Assessment Program (MCAP) Testing in Prince George’s County Elementary School. It specifically focuses on the 3rd grade version of the Math and ELA (English Language Arts) and the percentage of the students at each school who are proficient in each subject. It will also look at factors surrounding students in elementary schools such as attendance, race and income level to examine the intersections between these factors and proficiency levels. The MCAP testing data was pulled from the Maryland Department of Education’s Website. The rest of the data was pulled from the shared drive. The data has been cleaned and filtered to focus on PG County. The bulk of this data surrounds the Proficient Percentage data point from the MCAP data, meaning the percentage of the students that got a 3 or 4 on the MCAP test. The scale of the test is from 1 to 4 and 3 is considered proficient and 4 considered excellent. I focused on the Grade 3 MCAP test for this notebook. The other variables referenced are median income, census race percentages and elementary school attendance data.
```{r}
options(scipen=999)
library(tidyverse)
library(janitor)
library(rio)
library(dplyr)
library(leaflet)
library(sf)

```
Load Data 
```{r}
attendance <- rio::import("attendance.rds")
pg_county <- rio::import("pg_county.rds")
pg_elementary <- rio::import("pg_elementary_school_locations.rds")
pg_income <- rio::import("pg_tract_income.rds")
md_race <-read.csv("md_race_all_8_13.csv")
md_math <- rio::import("2023_MCAP_MATH_Administrative_Data_Report_Card.xlsx")
md_ela <- rio::import("2023_MCAP_ELA_Administrative_Data_Report_Card.xlsx")
md_crosswalk <-rio::import("maryland_tracts.xls")
geoid <- rio::import("md_counties_geoids.txt")


```
Clean Data
```{r}
pg_math <- md_math %>% 
  filter(LEA_Name == "Prince George's") %>% 
  filter(Assessment == "Mathematics 03") %>% 
  clean_names() 

pg_ela <- md_ela %>% 
  filter(LEA_Name == "Prince George's") %>% 
  filter(Assessment == "English Language Arts 03") %>% 
    clean_names() 


pg_math_ela <- pg_math %>% 
  inner_join(pg_ela, by="school_name") %>% 
  clean_names() %>% 
  rename(math_profic_pct=proficient_pct_x, ela_profic_pct=proficient_pct_y) %>% 
  select(school_name, math_profic_pct, ela_profic_pct) %>% 
  mutate(pg_math_ela1= as.numeric(math_profic_pct)) 
  

pg_income<- pg_income %>% 
st_as_sf()

pg_elementary2 <- pg_elementary %>% 
inner_join(attendance, by="school_name") %>% 
  st_as_sf()

pg_income_elementary <- pg_elementary2 %>%
  st_join(pg_income) 

pg_elementary_income_attendance <- pg_income_elementary %>% 
inner_join(attendance, by="school_name") %>% 
  clean_names() 

pg_elementary_income_attendance2<-pg_elementary_income_attendance %>%  
as.data.frame() %>% 
rename(tract = geoid) %>% 
  mutate(tract1= as.numeric(tract))


pg_elementary_income_attendance_race_crosswalk <- pg_elementary_income_attendance2 %>% 
inner_join(md_crosswalk, by=c("tract1" = "tract")) %>% 
  rename(attendance_rate = attend_rate_pct_x)
```

Questions 

Question 1
Is there a relationship between race and attendance in PG County elementary schools? 
```{r}
pg_race_attendance <- pg_elementary_income_attendance_race_crosswalk %>% 
  select(school_name, attendance_rate, black, white, asian) %>%
  arrange(desc(attendance_rate))

pg_race_attendance %>% 
ggplot(aes(x=attendance_rate, y=white))+
geom_point()+
   labs(
    title = "Percentage of White Student Compared to Attendance Rate",
    x = "Attendance Rate",
    y = "Pct of the white students",
    caption = "Data via Prince George's County Public School and the US Census"
    )

pg_race_attendance %>% 
ggplot(aes(x=attendance_rate, y=black))+
geom_point()+
   labs(
    title = "Percentage of Black Student Compared to Attendance Rate",
    x = "Attendance Rate",
    y = "Pct of the black students",
    caption = "Data via Prince George's County Public School and the US Census"
    )

pg_race_attendance %>% 
ggplot(aes(x=attendance_rate, y=asian))+
geom_point()+
   labs(
    title = "Percentage of Asian Student Compared to Attendance Rate",
    x = "Attendance Rate",
    y = "Pct of the asian students",
    caption = "Data via Prince George's County Public School and the US Census"
    )
```


Question 2
Is there a correlation between median income and attendance in PG County Elementary Schools? 
```{r}
pg_median_income_attendance <- pg_elementary_income_attendance_race_crosswalk %>% 
  select(school_name, attendance_rate, median_household_income) 


pg_median_income_attendance %>% 
ggplot(aes(x=attendance_rate, y=median_household_income))+
geom_point()+
  geom_smooth(aes(x = attendance_rate, y = median_household_income), method = "lm", color = "red", se = FALSE) +
labs(title = "Relationship between median income and attendance in the Prince George's County Schools",
     x = "Attendance Percentage" , y = "Household Median Income",)


```
Analysis
Previous research suggested this could be a trend in schools and this data does appear to back up the correlation between attendance and household income.

Question 3
Is there a correlation between test scores and median household income in PG County Elementary Schools?
```{r}
pg_math_ela_income <- pg_math_ela %>% 
   inner_join(pg_elementary_income_attendance_race_crosswalk, by="school_name") %>% 
  select(school_name, math_profic_pct, ela_profic_pct, median_household_income)

pg_math_ela_income <- pg_math_ela_income %>%
  mutate(math_profic_pct = as.numeric(math_profic_pct),
         ela_profic_pct = as.numeric(ela_profic_pct))

pg_math_ela_income %>% 
ggplot(aes(x=median_household_income)) +
  geom_point(aes(y= (math_profic_pct)), color = "red") +
  geom_point(aes(y=(ela_profic_pct)), color = "blue") +
   scale_y_continuous(breaks = seq(0, 100, by = 5)) +
  theme_classic()+
  labs(title = "Math and Ela Proficent Pergentages by Median Household Income",
       x = "Median Household Income",
       y = "Percentage of Students Proficent",
       caption = "Math represented by Red, ELA represented by Blue")


```

Question 4
Is there a relationship between test scores and attendance in PG County Elementary Schools? 
```{r}
pg_math_ela_attendence <- pg_math_ela %>% 
  inner_join(attendance, by="school_name") %>% 
  select(school_name, math_profic_pct, ela_profic_pct,attend_rate_pct)
         
pg_math_ela_attendence <- pg_math_ela_attendence %>%
  mutate(math_profic_pct = as.numeric(math_profic_pct),
         ela_profic_pct = as.numeric(ela_profic_pct))

pg_math_ela_attendence %>% 
ggplot(aes(x=attend_rate_pct)) +
  geom_point(aes(y= (math_profic_pct)), color = "red") +
  geom_point(aes(y=(ela_profic_pct)), color = "blue") +
   scale_y_continuous(breaks = seq(0, 100, by = 5)) +
  theme_classic()+
  labs(title = "Math and Ela Proficent Pergentages by Attendance Percentage",
       x = "Attendance Percentage",
       y = "Percentage of Students Proficent",
       caption = "Math represented by Red, ELA represented by Blue")

```


Question 5
Looking at the schools in Prince George's County with the highest test scores where do they rank in terms of attendance and median income?
```{r}
pg_math_ela_combined <- pg_math %>% 
  inner_join(pg_ela, by="school_name") %>% 
  clean_names() %>% 
  rename(math_profic_pct=proficient_pct_x, ela_profic_pct=proficient_pct_y, level_4_pct_math=level_4_pct_x, level_4_pct_ela=level_4_pct_y) %>% 
  select(school_name, level_4_pct_math, level_4_pct_ela) 


pg_math_ela_combined <- pg_math_ela_combined %>%
  mutate(level_4_pct_math = as.numeric(level_4_pct_math),
         level_4_pct_ela = as.numeric(level_4_pct_ela)) %>% 
  mutate(combined_pct=level_4_pct_math+level_4_pct_ela) %>% 
  arrange(desc(combined_pct)) %>% 
  slice_max(combined_pct, n=1)

pg_math_ela_combined 
  
#Glenarden Woods Elementary has the highest combined percentage of level 4 math and ela test scores.



```

Memo

